syntax = "proto3";

package fitglue;

import "google/protobuf/timestamp.proto";
import "google/protobuf/descriptor.proto";

option go_package = "fitglue/pkg/shared/pb";

// Extension for Strava activity type name mapping
extend google.protobuf.EnumValueOptions {
  string strava_name = 50010;
}

// ActivityType enum based on Strava's accepted activity types.
// Use the strava_name extension to get the exact Strava API string.
// Stored as string in Firestore for readability.
enum ActivityType {
  ACTIVITY_TYPE_UNSPECIFIED = 0;
  ACTIVITY_TYPE_ALPINE_SKI = 1 [(strava_name) = "AlpineSki"];
  ACTIVITY_TYPE_BACKCOUNTRY_SKI = 2 [(strava_name) = "BackcountrySki"];
  ACTIVITY_TYPE_BADMINTON = 3 [(strava_name) = "Badminton"];
  ACTIVITY_TYPE_CANOEING = 4 [(strava_name) = "Canoeing"];
  ACTIVITY_TYPE_CROSSFIT = 5 [(strava_name) = "Crossfit"];
  ACTIVITY_TYPE_EBIKE_RIDE = 6 [(strava_name) = "EBikeRide"];
  ACTIVITY_TYPE_ELLIPTICAL = 7 [(strava_name) = "Elliptical"];
  ACTIVITY_TYPE_EMOUNTAIN_BIKE_RIDE = 8 [(strava_name) = "EMountainBikeRide"];
  ACTIVITY_TYPE_GOLF = 9 [(strava_name) = "Golf"];
  ACTIVITY_TYPE_GRAVEL_RIDE = 10 [(strava_name) = "GravelRide"];
  ACTIVITY_TYPE_HANDCYCLE = 11 [(strava_name) = "Handcycle"];
  ACTIVITY_TYPE_HIGH_INTENSITY_INTERVAL_TRAINING = 12 [(strava_name) = "HighIntensityIntervalTraining"];
  ACTIVITY_TYPE_HIKE = 13 [(strava_name) = "Hike"];
  ACTIVITY_TYPE_ICE_SKATE = 14 [(strava_name) = "IceSkate"];
  ACTIVITY_TYPE_INLINE_SKATE = 15 [(strava_name) = "InlineSkate"];
  ACTIVITY_TYPE_KAYAKING = 16 [(strava_name) = "Kayaking"];
  ACTIVITY_TYPE_KITESURF = 17 [(strava_name) = "Kitesurf"];
  ACTIVITY_TYPE_MOUNTAIN_BIKE_RIDE = 18 [(strava_name) = "MountainBikeRide"];
  ACTIVITY_TYPE_NORDIC_SKI = 19 [(strava_name) = "NordicSki"];
  ACTIVITY_TYPE_PICKLEBALL = 20 [(strava_name) = "Pickleball"];
  ACTIVITY_TYPE_PILATES = 21 [(strava_name) = "Pilates"];
  ACTIVITY_TYPE_RACQUETBALL = 22 [(strava_name) = "Racquetball"];
  ACTIVITY_TYPE_RIDE = 23 [(strava_name) = "Ride"];
  ACTIVITY_TYPE_ROCK_CLIMBING = 24 [(strava_name) = "RockClimbing"];
  ACTIVITY_TYPE_ROLLER_SKI = 25 [(strava_name) = "RollerSki"];
  ACTIVITY_TYPE_ROWING = 26 [(strava_name) = "Rowing"];
  ACTIVITY_TYPE_RUN = 27 [(strava_name) = "Run"];
  ACTIVITY_TYPE_SAIL = 28 [(strava_name) = "Sail"];
  ACTIVITY_TYPE_SKATEBOARD = 29 [(strava_name) = "Skateboard"];
  ACTIVITY_TYPE_SNOWBOARD = 30 [(strava_name) = "Snowboard"];
  ACTIVITY_TYPE_SNOWSHOE = 31 [(strava_name) = "Snowshoe"];
  ACTIVITY_TYPE_SOCCER = 32 [(strava_name) = "Soccer"];
  ACTIVITY_TYPE_SQUASH = 33 [(strava_name) = "Squash"];
  ACTIVITY_TYPE_STAIR_STEPPER = 34 [(strava_name) = "StairStepper"];
  ACTIVITY_TYPE_STAND_UP_PADDLING = 35 [(strava_name) = "StandUpPaddling"];
  ACTIVITY_TYPE_SURFING = 36 [(strava_name) = "Surfing"];
  ACTIVITY_TYPE_SWIM = 37 [(strava_name) = "Swim"];
  ACTIVITY_TYPE_TABLE_TENNIS = 38 [(strava_name) = "TableTennis"];
  ACTIVITY_TYPE_TENNIS = 39 [(strava_name) = "Tennis"];
  ACTIVITY_TYPE_TRAIL_RUN = 40 [(strava_name) = "TrailRun"];
  ACTIVITY_TYPE_VELOMOBILE = 41 [(strava_name) = "Velomobile"];
  ACTIVITY_TYPE_VIRTUAL_RIDE = 42 [(strava_name) = "VirtualRide"];
  ACTIVITY_TYPE_VIRTUAL_ROW = 43 [(strava_name) = "VirtualRow"];
  ACTIVITY_TYPE_VIRTUAL_RUN = 44 [(strava_name) = "VirtualRun"];
  ACTIVITY_TYPE_WALK = 45 [(strava_name) = "Walk"];
  ACTIVITY_TYPE_WEIGHT_TRAINING = 46 [(strava_name) = "WeightTraining"];
  ACTIVITY_TYPE_WHEELCHAIR = 47 [(strava_name) = "Wheelchair"];
  ACTIVITY_TYPE_WINDSURF = 48 [(strava_name) = "Windsurf"];
  ACTIVITY_TYPE_WORKOUT = 49 [(strava_name) = "Workout"];
  ACTIVITY_TYPE_YOGA = 50 [(strava_name) = "Yoga"];
}

// StandardizedActivity represents a normalized fitness activity.
// It is designed to be the canonical input format for the Enricher,
// decoupling it from specific ingestion sources (Hevy, etc).
//
// Structure mimics the FIT SDK hierarchy:
// Activity -> Sessions -> Laps -> Records
message StandardizedActivity {
  string source = 1;      // e.g. "HEVY"
  string external_id = 2; // Source's ID (e.g. Hevy workout ID)
  string user_id = 3;

  // High-level summary
  google.protobuf.Timestamp start_time = 4;
  string name = 5;        // e.g. "Morning Run"
  ActivityType type = 6;  // Strava-compatible activity type

  // Hierarchy
  repeated Session sessions = 7;

  // Rich metadata (preserved from source)
  string description = 8; // User notes
  repeated string tags = 9;
  string notes = 10;
}

message Session {
  google.protobuf.Timestamp start_time = 1;
  double total_elapsed_time = 2; // seconds
  double total_distance = 3;     // meters
  repeated Lap laps = 4;

  // High-fidelity strength data (not just 1Hz streams)
  repeated StrengthSet strength_sets = 5;
}

message Lap {
  google.protobuf.Timestamp start_time = 1;
  double total_elapsed_time = 2; // seconds
  double total_distance = 3;     // meters
  repeated Record records = 4;
}

// Record represents a single data point in time (1Hz is typical)
message Record {
  google.protobuf.Timestamp timestamp = 1;

  // Core Telemetry
  int32 heart_rate = 2;     // bpm
  int32 power = 3;          // watts
  int32 cadence = 4;        // rpm
  double speed = 5;         // m/s
  double altitude = 6;      // meters

  // Location
  double position_lat = 7;
  double position_long = 8;
}

// StrengthSet represents a discrete set of an exercise (common in weightlifting)
// This is distinct from continuous Record streams.
message StrengthSet {
  string exercise_name = 1; // e.g. "Bench Press"
  int32 reps = 2;
  double weight_kg = 3;
  google.protobuf.Timestamp start_time = 4;
  int32 duration_seconds = 5;
  string notes = 6;

  // Organization
  string superset_id = 7; // Group ID for supersets (if applicable)

  // Muscle Targeting
  MuscleGroup primary_muscle_group = 8;
  repeated MuscleGroup secondary_muscle_groups = 9;

  // Distance (for cardio/distance-based exercises)
  double distance_meters = 10;

  // Set Type (warmup, normal, failure, dropset)
  string set_type = 11;
}

enum MuscleGroup {
  MUSCLE_GROUP_UNSPECIFIED = 0;
  MUSCLE_GROUP_ABDOMINALS = 1;
  MUSCLE_GROUP_SHOULDERS = 2;
  MUSCLE_GROUP_BICEPS = 3;
  MUSCLE_GROUP_TRICEPS = 4;
  MUSCLE_GROUP_FOREARMS = 5;
  MUSCLE_GROUP_QUADRICEPS = 6;
  MUSCLE_GROUP_HAMSTRINGS = 7;
  MUSCLE_GROUP_CALVES = 8;
  MUSCLE_GROUP_GLUTES = 9;
  MUSCLE_GROUP_ABDUCTORS = 10;
  MUSCLE_GROUP_ADDUCTORS = 11;
  MUSCLE_GROUP_LATS = 12;
  MUSCLE_GROUP_UPPER_BACK = 13;
  MUSCLE_GROUP_TRAPS = 14;
  MUSCLE_GROUP_LOWER_BACK = 15;
  MUSCLE_GROUP_CHEST = 16;
  MUSCLE_GROUP_CARDIO = 17;
  MUSCLE_GROUP_NECK = 18;
  MUSCLE_GROUP_FULL_BODY = 19;
  MUSCLE_GROUP_OTHER = 20;
}
